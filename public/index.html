<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="css/joint.css"/>
    <link rel="stylesheet" type="text/css" href="css/app.css"/>
    <link rel="stylesheet" href="css/jquery-ui.css"/>
    <link rel="stylesheet" href="css/jquery-ui.theme.css"/>
    <link rel="stylesheet" href="css/selectize.legacy.css"/>
    <link rel="stylesheet" href="css/selectize.default.css"/>
    <link rel="stylesheet" href="css/selectize.css"/>
    <!-- dependencies -->
    <script src="libraries/aceeditor/1.4.3/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="libraries/jquery-3.3.1.js"></script>
    <script src="libraries/jquery.fittext.js"></script>
    <script src="libraries/selectize.js"></script>
    <script src="libraries/lodash/4.17.11/lodash.js"></script>
    <script src="libraries/backbone/1.3.3/backbone.js"></script>
    <script src="libraries/joint/2.2.1/joint.js"></script>
    <script src="libraries/jquery-ui.js"></script>

    <!-- dependencies (jquery, handlebars and bootstrap) -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
    <link type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <!-- alpaca -->
    <link type="text/css" href="//code.cloudcms.com/alpaca/1.5.24/bootstrap/alpaca.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="//code.cloudcms.com/alpaca/1.5.24/bootstrap/alpaca.min.js"></script>


    <script src="libraries/steps-model.js"></script>
    <script src="libraries/pipelines-model.js"></script>
    <script src="libraries/schemas-model.js"></script>
    <script src="libraries/services.js"></script>
    <script src="libraries/add-step-dialog.js"></script>
    <script src="libraries/alert-dialog.js"></script>
    <script src="libraries/clear-form-dialog.js"></script>
    <script src="libraries/code-editor-dialog.js"></script>
    <script src="libraries/copy-pipeline-dialog.js"></script>
    <script src="libraries/new-dialog.js"></script>
    <script src="libraries/object-editor-dialog.js"></script>
    <script src="libraries/settings-dialog.js"></script>
    <script src="libraries/validation-error-dialog.js"></script>
    <script src="libraries/steps-editor.js"></script>
    <script src="libraries/pipeline-editor.js"></script>
    <script src="libraries/application-editor.js"></script>
    <script src="libraries/app.js"></script>
    <title>Application Manager</title>
</head>
<body>
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Application Editor</a></li>
        <li><a href="#tabs-2">Pipeline Editor</a></li>
        <li><a href="#tabs-3">Step Editor</a></li>
    </ul>
    <div id="tabs-1">
        <div style="height: 10%; width:100%; margin-bottom: 10px;">
            <div class="top-name">
                <label id="application-label">Application:</label><span id="applicationName"></span>
            </div>
            <div class="top-buttons">
                <button id="save-application-button" class="ui-button ui-widget ui-corner-all">Save</button>
                <button id="new-application-button" class="ui-button ui-widget ui-corner-all">New</button>
                <button id="reset-application-button" class="ui-button ui-widget ui-corner-all">Reset</button>
            </div>
        </div>
        <div class="left">
            <div class="panel">
                <div class="panel-heading"><span>Applications</span></div>
                <div class="panel-body">
                    <div>
                        <div class="form-group">
                            <select name="applications" id="applications"></select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-heading"><span>Execution Pipelines</span></div>
                <div id="pipeline-panel" class="panel-body step-panel"></div>
            </div>
        </div>
        <div class="right">
            <div id="executionDesigner" class="joint-paper joint-theme-default"
                 style="display: inline-block; float: left;"
                 ondrop="dropStep(event)"
                 ondragover="allowStepDrop(event)"></div>
            <div style="width: 5%; display: inline-block; float: right;">
                <button id="edit-application-button"
                        class="ui-button ui-widget ui-corner-all ui-button-icon-only"
                        title="Edit Application Settings"
                        style="margin-bottom: 8px">
                    <span class="ui-icon ui-icon-wrench"></span>Edit Application Settings
                </button>
                <button id="add-execution-button"
                        class="ui-button ui-widget ui-corner-all ui-button-icon-only"
                        title="Add Execution">
                    <span class="ui-icon ui-icon-plus"></span>Add Execution
                </button>
            </div>
        </div>
    </div>
    <div id="tabs-2">
        <div>
            <div style="height: 10%; width:100%; margin-bottom: 10px;">
                <div class="top-name">
                    <label id="pipeline-label">Pipeline:</label><span id="pipelineName"></span>
                </div>
                <div class="top-buttons">
                    <button id="save-button" class="ui-button ui-widget ui-corner-all">Save</button>
                    <button id="new-button" class="ui-button ui-widget ui-corner-all">New</button>
                    <button id="copy-button" class="ui-button ui-widget ui-corner-all">Copy</button>
                    <button id="reset-button" class="ui-button ui-widget ui-corner-all">Reset</button>
                </div>
            </div>
            <div class="left">
                <div class="panel">
                    <div class="panel-heading"><span>Pipelines</span></div>
                    <div class="panel-body">
                        <div>
                            <div class="form-group">
                                <select name="pipelines" id="pipelines"></select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel">
                    <div class="panel-heading"><span>Steps</span></div>
                    <div id="step-panel" class="panel-body step-panel"></div>
                </div>
                <div id="step-properties" class="panel">
                    <div class="panel-heading"><span>Step Data</span></div>
                    <div class="panel-body">
                        <div id="step-form">
                            <div class="form-group">
                                <label>Id:</label>
                                <div id="pipelineStepId"></div>
                            </div>
                            <div class="form-group">
                                <label>Step Id:</label>
                                <div id="stepId"></div>
                            </div>
                            <div class="form-group">
                                <label>Name:</label>
                                <div id="displayName"></div>
                            </div>
                            <div class="form-group">
                                <label>Description:</label>
                                <div id="description"></div>
                            </div>
                            <div class="form-group">
                                <label>Type:</label>
                                <div id="type"></div>
                            </div>
                        </div>
                    </div>
                    <div id="step-parameters-form" class="panel-body">
                        <div></div>
                    </div>
                </div>
            </div>
            <!-- TODO Add a slider to allow zoom on canvas -->
            <div class="right">
                <div id="pipelineDesigner" class="joint-paper joint-theme-default" style="width: 100%"
                     ondrop="dropStep(event)"
                     ondragover="allowStepDrop(event)"></div>
            </div>
        </div>
    </div>
    <div id="tabs-3">
        <div style="height: 10%; width:100%; margin-bottom: 10px;">
            <div class="top-buttons" style="width: 100%">
                <button id="bulk-step-button" class="ui-button ui-widget ui-corner-all">Add Bulk</button>
                <button id="save-step-button" class="ui-button ui-widget ui-corner-all">Save</button>
                <button id="new-step-button" class="ui-button ui-widget ui-corner-all">New</button>
                <button id="reset-step-button" class="ui-button ui-widget ui-corner-all">Reset</button>
            </div>
        </div>
        <div class="left" style="overflow: auto">
            <div class="panel">
                <div class="panel-heading"><span>Steps</span></div>
                <div id="step-selector-panel" class="panel-body step-selector-panel">
                    <ol id="step-selector" style="width: 100%"></ol>
                </div>
            </div>
        </div>
        <div class="right">
            <div id="edit-step-form" class="panel panel-body">
                <div class="step-form">
                    <label>Id:</label>
                    <div id="edit-stepId"></div>
                </div>
                <div class="step-form">
                    <label>Name:</label><input id="edit-displayName"/>
                </div>
                <div class="step-form">
                    <label>Description:</label><input id="edit-description"/>
                </div>
                <div class="step-form">
                    <label>Engine Meta:</label><input id="edit-engineMeta"/>
                </div>
                <div id="branch-type" class="step-form">
                    <label>Type:</label>
                    <div>
                        <label for="pipelineRadio">Pipeline</label>
                        <input type="radio" name="stepTypeRadio" value="Pipeline" id="pipelineRadio">
                        <label for="branchRadio">Branch</label>
                        <input type="radio" name="stepTypeRadio" value="branch" id="branchRadio">
                    </div>
                </div>
                <div class="step-form">
                    <label>Modified Date:</label>
                    <div id="step-modifiedDate"></div>
                </div>
                <div class="step-form">
                    <label>Creation Date:</label>
                    <div id="step-creationDate"></div>
                </div>
                <!-- Dynamic parameters panel -->
                <div>
                    <div style="height: 10%; width:100%; margin-bottom: 10px;">
                        <div class="step-parameters-name"><label>Parameters</label></div>
                        <div class="top-buttons">
                            <button id="add-step-parameter-button"
                                    class="ui-button ui-widget ui-corner-all ui-button-icon-only"
                                    title="Add Parameter">
                                <span class="ui-icon ui-icon-plus"></span>Add Parameter
                            </button>
                        </div>
                    </div>
                    <div id="edit-step-parameters"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal dialog -->
<div id="dialog-confirm" title="Clear Form?">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;">
    </span>These items will be permanently deleted and cannot be recovered. Are you sure?</p>
</div>
<!-- Add step dialog -->
<div id="dialog-step-form" title="Add Step">
    <p class="validateTips">Enter a unique id for this step.</p>
    <form id="add-step-form">
        <fieldset>
            <label for="add-step-id">Name</label>
            <input type="text" name="name" id="add-step-id" value="" class="text ui-widget-content ui-corner-all">
        </fieldset>
    </form>
</div>
<!-- Add pipeline dialog -->
<div id="dialog-new-form" title="New">
    <p class="validateTips">Enter a name.</p>
    <form id="add-new-form">
        <fieldset>
            <label for="add-new-id">Name</label>
            <input type="text" name="name" id="add-new-id" value="" class="text ui-widget-content ui-corner-all">
        </fieldset>
    </form>
</div>
<!-- Object Editor dialog -->
<div class="modal fade" id="edit-object-form" tabindex="-1" role="dialog" aria-labelledby="Edit Object"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit Object</h5>
                <button id="edit-object-form-close" type="button" class="close" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="schema-selection">
                    <span>Schema:</span>
                    <select id="objectEditorSchema"></select>
                </div>
                <div id="json-object-editor"></div>
            </div>
            <div class="modal-footer">
                <button id="edit-object-form-save" type="button" class="btn btn-primary">Save</button>
                <button id="edit-object-form-cancel" type="button" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>
</div>
<!-- validation save errors dialog -->
<div id="dialog-validation-error" title="Validation Error!">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;">
    </span>There were errors with the changes. The following parameters are required:</p>
    <div id="dialog-validation-error-field"></div>
</div>
<!-- alert dialog -->
<div id="dialog-alert" title="Error!">
    <span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>
    <span id="dialog-alert-field" style="float:left; margin:12px 12px 20px 0;"></span>
</div>
<!-- Code Editor Dialog -->
<div id="dialog-editor" title="Edit Code">
    <div id="syntax-selection">
        <span>Syntax:</span>
        <select id="codeEditorSyntax">
            <option value="scala">Scala</option>
            <option value="javascript">Javascript</option>
            <option value="json">JSON</option>
            <option value="sql">SQL</option>
        </select>
    </div>
    <div id="code-editor"></div>
</div>
<!-- Copy pipeline dialog -->
<div id="dialog-copy-pipeline-form" title="Copy Pipeline">
    <form id="copy-pipeline-form">
        <div class="form-group">
            <label for="copy-pipeline-id">Choose source pipeline</label>
            <select name="pipelines" id="source-pipelines"></select>
        </div>
        <div class="form-group">
            <label for="copy-pipeline-id">Name</label>
            <input type="text" name="name" id="copy-pipeline-id" value="" class="text ui-widget-content ui-corner-all">
        </div>
    </form>
</div>
<!-- Settings dialog -->
<div id="dialog-settings-form" title="Copy Pipeline">
    <div class="panel">
        <div class="panel-heading"><span>Spark Configuration</span></div>
        <div id="spark-conf-fields" class="panel-body">
            <div class="form-group">
                <label for="kyro-classes">Kyro Classes</label>
                <input id="kyro-classes" type="text"/>
            </div>
            <div style="height: 10%; width:100%; margin-bottom: 10px;">
                <div class="step-parameters-name"><label>Parameters</label></div>
                <div class="top-buttons">
                    <button id="add-spark-option-button"
                            class="ui-button ui-widget ui-corner-all ui-button-icon-only"
                            title="Add Option">
                        <span class="ui-icon ui-icon-plus"></span>Add Option
                    </button>
                </div>
            </div>
            <div id="spark-conf-options"></div>
        </div>
    </div>
    <div class="panel">
        <div class="panel-heading"><span>Global Overrides</span></div>
        <div class="panel-body">
            <div class="form-group">
                <label for="step-packages">Step Packages</label>
                <input id="step-packages" type="text"/>
            </div>
            <div class="form-group">
                <label for="required-parameters">Required Parameters</label>
                <input id="required-parameters" type="text"/>
            </div>
            <div class="form-group settings-form">
                <label for="pipeline-listener">Pipeline Listener</label>
                <input id="pipeline-listener" type="text"/>
            </div>
            <div class="form-group settings-form">
                <label for="security-manager">Security Manager</label>
                <input id="security-manager" type="text"/>
            </div>
            <div class="form-group settings-form">
                <label for="step-mapper">Step Mapper</label>
                <input id="step-mapper" type="text"/>
            </div>
        </div>
    </div>
</div>
</body>
</html>
